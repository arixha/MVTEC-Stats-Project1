---
title: "R Notebook - prepping data for assignment"
output: html_notebook
---
Setting up my R environment

```{r}
library(dplyr)
library(tidyr)
library(readxl)

```

*Step 1*: Import 3 datasets

```{r}

#Data import
country_info = read_excel("originalData/country-info.xlsx")
originalCovid = read.csv(file = "originalData/owid-covid-data-28112020.csv")
ghsIndex = read.csv(file = "additionalData/globalSecurityIndex .csv")

head(country_info)
head(originalCovid)
head(ghsIndex)
```

```{r}
#For originalCovid, make sure date column is reading as date.

dtCorrectedCovid = originalCovid %>%
    mutate(date = as.Date(date, format="%Y-%m-%d"))

head(dtCorrectedCovid)

```

*Step 2*: Join the three datasets

```{r}
mergedData = dtCorrectedCovid %>%
    inner_join(country_info, c("location" = "COUNTRY"))  %>%
    inner_join(ghsIndex, c("location" = "Country"))

sapply(mergedData, class)
head(mergedData)

```

*Step 3*: Aggregate data into fortnights

```{r}
mergedData %>%
  mutate(week = format(date, format="%W")) %>% #Add a new column with the 'week' number
  filter(date > "2020-01-01") %>%
#grabbing just the week doesn't always work, I'd need to further group by YEAR > WEEK, if data flows across years which in this case it just might. So, if we have data for Week 52 in December 2019 + Week 52 in December 2020, I'd be aggregating both accidentally.
  group_by(week)
   
```


